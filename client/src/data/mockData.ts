import type {
  User,
  Proyecto,
  Visita,
  Pendiente,
  Nota,
  Documento,
  Notificacion,
  PresupuestoItem,
  Permiso
} from '../types';

// ==================== Helper para fechas ====================

const today = new Date();
const daysAgo = (days: number) => new Date(today.getTime() - days * 24 * 60 * 60 * 1000);
const daysFromNow = (days: number) => new Date(today.getTime() + days * 24 * 60 * 60 * 1000);

// ==================== USUARIOS / EQUIPO ====================

export const mockUsers: User[] = [
  {
    id: 'user-1',
    email: 'maria.gonzalez@estudio.cl',
    nombre: 'María González',
    rol: 'admin',
    telefono: '+56912345678',
    especialidad: 'Dirección de Proyectos',
    avatar: undefined,
    proyectos: [],
    createdAt: daysAgo(365),
    updatedAt: daysAgo(1),
  },
  {
    id: 'user-2',
    email: 'carlos.mendez@estudio.cl',
    nombre: 'Carlos Méndez',
    rol: 'jefe_proyecto',
    telefono: '+56923456789',
    especialidad: 'Arquitectura',
    avatar: undefined,
    proyectos: [],
    createdAt: daysAgo(300),
    updatedAt: daysAgo(2),
  },
  {
    id: 'user-3',
    email: 'jose.silva@construccion.cl',
    nombre: 'José Silva',
    rol: 'especialista',
    telefono: '+56934567890',
    especialidad: 'Constructor Civil',
    avatar: undefined,
    proyectos: [],
    createdAt: daysAgo(200),
    updatedAt: daysAgo(3),
  },
  {
    id: 'user-4',
    email: 'pedro.rojas@electrico.cl',
    nombre: 'Pedro Rojas',
    rol: 'especialista',
    telefono: '+56945678901',
    especialidad: 'Electricista',
    avatar: undefined,
    proyectos: [],
    createdAt: daysAgo(150),
    updatedAt: daysAgo(5),
  },
  {
    id: 'user-5',
    email: 'miguel.torres@sanitario.cl',
    nombre: 'Miguel Torres',
    rol: 'especialista',
    telefono: '+56956789012',
    especialidad: 'Gasfiter',
    avatar: undefined,
    proyectos: [],
    createdAt: daysAgo(150),
    updatedAt: daysAgo(4),
  },
  {
    id: 'user-6',
    email: 'andres.fuentes@pintura.cl',
    nombre: 'Andrés Fuentes',
    rol: 'especialista',
    telefono: '+56967890123',
    especialidad: 'Pintor',
    avatar: undefined,
    proyectos: [],
    createdAt: daysAgo(100),
    updatedAt: daysAgo(7),
  },
  {
    id: 'user-7',
    email: 'david.castro@carpinteria.cl',
    nombre: 'David Castro',
    rol: 'especialista',
    telefono: '+56978901234',
    especialidad: 'Carpintero',
    avatar: undefined,
    proyectos: [],
    createdAt: daysAgo(90),
    updatedAt: daysAgo(2),
  },
  {
    id: 'user-8',
    email: 'cliente@gmail.com',
    nombre: 'Roberto Sánchez',
    rol: 'cliente',
    telefono: '+56989012345',
    especialidad: undefined,
    avatar: undefined,
    proyectos: [],
    createdAt: daysAgo(400),
    updatedAt: daysAgo(10),
  },
];

// Helper para obtener usuario por ID
export const getUserById = (id: string) => mockUsers.find(u => u.id === id);

// ==================== PROYECTO ====================

export const mockProyecto: Proyecto = {
  id: 'proyecto-1',
  nombre: 'Remodelación Casa Sánchez',
  cliente: 'Roberto Sánchez',
  estado: 'en_obra',
  fechaInicio: daysAgo(90),
  fechaEstimadaFin: daysFromNow(60),
  direccion: 'Av. Las Condes 12345, Las Condes',
  descripcion: 'Remodelación integral de casa de 180m², incluyendo cocina, baños y ampliación de terraza.',
  presupuestoTotal: 85000000,
  usuarios: mockUsers,
  visitas: [],
  pendientes: [],
  documentos: [],
  notas: [],
  presupuestoItems: [],
  createdAt: daysAgo(120),
  updatedAt: daysAgo(1),
};

// ==================== VISITAS ====================

export const mockVisitas: Visita[] = [
  // Visita futura programada (próxima visita)
  {
    id: 'visita-0',
    proyectoId: 'proyecto-1',
    fecha: daysFromNow(3),
    hora: '10:00',
    estado: 'programada',
    notasGenerales: 'Revisión de avance de cocina y definición de detalles de iluminación.',
    asuntos: [],
    creadoPor: 'user-2',
    createdAt: daysAgo(1),
    updatedAt: daysAgo(1),
  },
  // Visita futura programada
  {
    id: 'visita-f1',
    proyectoId: 'proyecto-1',
    fecha: daysFromNow(10),
    hora: '15:00',
    estado: 'programada',
    notasGenerales: 'Reunión con cliente para revisión de acabados.',
    asuntos: [],
    creadoPor: 'user-1',
    createdAt: daysAgo(2),
    updatedAt: daysAgo(2),
  },
  // Visitas pasadas completadas
  {
    id: 'visita-1',
    proyectoId: 'proyecto-1',
    fecha: daysAgo(2),
    hora: '09:00',
    estado: 'completada',
    notasGenerales: 'Revisión de avances en cocina y baño principal. Instalación de cerámicos completada. Se detectaron algunos detalles a corregir.',
    asuntos: [
      {
        id: 'a1',
        visitaId: 'visita-1',
        area: 'Cocina',
        descripcion: 'Revisar instalación de muebles bajo mesón',
        encargadoId: 'user-7',
        convertidoAPendiente: true,
        pendienteId: 'pend-1',
        createdAt: daysAgo(2),
      },
      {
        id: 'a2',
        visitaId: 'visita-1',
        area: 'Baño principal',
        descripcion: 'Verificar sellado de cerámicos en ducha',
        encargadoId: 'user-5',
        convertidoAPendiente: true,
        pendienteId: 'pend-2',
        createdAt: daysAgo(2),
      },
      {
        id: 'a3',
        visitaId: 'visita-1',
        area: 'Cocina',
        descripcion: 'Confirmar ubicación de luminarias',
        encargadoId: 'user-4',
        convertidoAPendiente: false,
        createdAt: daysAgo(2),
      },
    ],
    creadoPor: 'user-2',
    createdAt: daysAgo(2),
    updatedAt: daysAgo(2),
  },
  {
    id: 'visita-2',
    proyectoId: 'proyecto-1',
    fecha: daysAgo(9),
    hora: '11:30',
    estado: 'completada',
    notasGenerales: 'Reunión con especialistas de iluminación. Definición de luminarias para sala y comedor. Cliente aprobó propuesta.',
    asuntos: [
      {
        id: 'a4',
        visitaId: 'visita-2',
        area: 'Sala de estar',
        descripcion: 'Definir tipo de luminarias empotradas',
        convertidoAPendiente: true,
        pendienteId: 'pend-5',
        createdAt: daysAgo(9),
      },
      {
        id: 'a5',
        visitaId: 'visita-2',
        area: 'Comedor',
        descripcion: 'Ubicación de lámpara colgante central',
        convertidoAPendiente: false,
        createdAt: daysAgo(9),
      },
    ],
    creadoPor: 'user-2',
    createdAt: daysAgo(9),
    updatedAt: daysAgo(9),
  },
  {
    id: 'visita-3',
    proyectoId: 'proyecto-1',
    fecha: daysAgo(16),
    hora: '14:00',
    estado: 'completada',
    notasGenerales: 'Inspección de trabajos de construcción. Avance según cronograma. Se revisó estructura de terraza.',
    asuntos: [
      {
        id: 'a6',
        visitaId: 'visita-3',
        area: 'Terraza',
        descripcion: 'Revisar impermeabilización',
        encargadoId: 'user-3',
        convertidoAPendiente: true,
        pendienteId: 'pend-8',
        createdAt: daysAgo(16),
      },
    ],
    creadoPor: 'user-1',
    createdAt: daysAgo(16),
    updatedAt: daysAgo(16),
  },
  {
    id: 'visita-4',
    proyectoId: 'proyecto-1',
    fecha: daysAgo(23),
    hora: '10:00',
    estado: 'completada',
    notasGenerales: 'Inicio de trabajos en baño de servicio. Demolición completada.',
    asuntos: [],
    creadoPor: 'user-2',
    createdAt: daysAgo(23),
    updatedAt: daysAgo(23),
  },
  {
    id: 'visita-5',
    proyectoId: 'proyecto-1',
    fecha: daysAgo(30),
    hora: '09:30',
    estado: 'completada',
    notasGenerales: 'Revisión de planos actualizados con cliente. Aprobación de cambios en cocina.',
    asuntos: [],
    creadoPor: 'user-1',
    createdAt: daysAgo(30),
    updatedAt: daysAgo(30),
  },
];

export const getProximaVisita = (visitas: Visita[]): Date | undefined => {
  const now = new Date();
  const futureVisitas = visitas
    .filter(v => new Date(v.fecha) > now && v.estado === 'programada')
    .sort((a, b) => new Date(a.fecha).getTime() - new Date(b.fecha).getTime());

  return futureVisitas.length > 0 ? new Date(futureVisitas[0].fecha) : undefined;
};

// ==================== PENDIENTES (TAREAS) ====================

export const mockPendientes: Pendiente[] = [
  // Cocina
  {
    id: 'pend-1',
    proyectoId: 'proyecto-1',
    area: 'Cocina',
    tarea: 'Revisar instalación de muebles bajo mesón',
    descripcion: 'Verificar nivelación y ajuste de puertas de muebles',
    encargadoId: 'user-7',
    encargado: { id: 'user-7', nombre: 'David Castro', especialidad: 'Carpintero', telefono: '+56978901234' },
    estado: 'en_obra',
    prioridad: 'alta',
    fechaCreacion: daysAgo(2),
    fechaVencimiento: daysFromNow(2),
    creadoPor: 'user-2',
    visitaId: 'visita-1',
    asuntoId: 'a1',
    createdAt: daysAgo(2),
    updatedAt: daysAgo(1),
  },
  {
    id: 'pend-3',
    proyectoId: 'proyecto-1',
    area: 'Cocina',
    tarea: 'Instalar campana extractora',
    descripcion: 'Campana de 90cm con ducto hacia exterior',
    encargadoId: 'user-4',
    encargado: { id: 'user-4', nombre: 'Pedro Rojas', especialidad: 'Electricista', telefono: '+56945678901' },
    estado: 'pausa',
    prioridad: 'media',
    fechaCreacion: daysAgo(5),
    fechaVencimiento: daysFromNow(7),
    creadoPor: 'user-2',
    createdAt: daysAgo(5),
    updatedAt: daysAgo(3),
  },
  {
    id: 'pend-4',
    proyectoId: 'proyecto-1',
    area: 'Cocina',
    tarea: 'Conectar grifería',
    encargadoId: 'user-5',
    encargado: { id: 'user-5', nombre: 'Miguel Torres', especialidad: 'Gasfiter', telefono: '+56956789012' },
    estado: 'terminado',
    prioridad: 'alta',
    fechaCreacion: daysAgo(10),
    fechaCompletado: daysAgo(3),
    creadoPor: 'user-3',
    createdAt: daysAgo(10),
    updatedAt: daysAgo(3),
  },
  // Baño principal
  {
    id: 'pend-2',
    proyectoId: 'proyecto-1',
    area: 'Baño principal',
    tarea: 'Verificar sellado de cerámicos en ducha',
    descripcion: 'Revisar silicona en esquinas y uniones',
    encargadoId: 'user-5',
    encargado: { id: 'user-5', nombre: 'Miguel Torres', especialidad: 'Gasfiter', telefono: '+56956789012' },
    estado: 'en_obra',
    prioridad: 'alta',
    fechaCreacion: daysAgo(2),
    fechaVencimiento: daysFromNow(1),
    creadoPor: 'user-2',
    visitaId: 'visita-1',
    asuntoId: 'a2',
    createdAt: daysAgo(2),
    updatedAt: daysAgo(1),
  },
  {
    id: 'pend-9',
    proyectoId: 'proyecto-1',
    area: 'Baño principal',
    tarea: 'Instalar mueble vanitorio',
    encargadoId: 'user-7',
    encargado: { id: 'user-7', nombre: 'David Castro', especialidad: 'Carpintero', telefono: '+56978901234' },
    estado: 'pausa',
    prioridad: 'media',
    fechaCreacion: daysAgo(4),
    fechaVencimiento: daysFromNow(5),
    creadoPor: 'user-2',
    createdAt: daysAgo(4),
    updatedAt: daysAgo(2),
  },
  // Sala de estar
  {
    id: 'pend-5',
    proyectoId: 'proyecto-1',
    area: 'Sala de estar',
    tarea: 'Instalar luminarias empotradas',
    descripcion: '8 luminarias LED empotradas según plano',
    encargadoId: 'user-4',
    encargado: { id: 'user-4', nombre: 'Pedro Rojas', especialidad: 'Electricista', telefono: '+56945678901' },
    estado: 'en_obra',
    prioridad: 'media',
    fechaCreacion: daysAgo(9),
    fechaVencimiento: daysFromNow(4),
    creadoPor: 'user-2',
    visitaId: 'visita-2',
    asuntoId: 'a4',
    createdAt: daysAgo(9),
    updatedAt: daysAgo(5),
  },
  {
    id: 'pend-6',
    proyectoId: 'proyecto-1',
    area: 'Sala de estar',
    tarea: 'Pintar muros',
    descripcion: 'Color blanco hueso, 2 manos',
    encargadoId: 'user-6',
    encargado: { id: 'user-6', nombre: 'Andrés Fuentes', especialidad: 'Pintor', telefono: '+56967890123' },
    estado: 'pausa',
    prioridad: 'baja',
    fechaCreacion: daysAgo(7),
    fechaVencimiento: daysFromNow(14),
    creadoPor: 'user-2',
    createdAt: daysAgo(7),
    updatedAt: daysAgo(7),
  },
  // Terraza
  {
    id: 'pend-8',
    proyectoId: 'proyecto-1',
    area: 'Terraza',
    tarea: 'Completar impermeabilización',
    descripcion: 'Segunda capa de membrana asfáltica',
    encargadoId: 'user-3',
    encargado: { id: 'user-3', nombre: 'José Silva', especialidad: 'Constructor Civil', telefono: '+56934567890' },
    estado: 'terminado',
    prioridad: 'alta',
    fechaCreacion: daysAgo(16),
    fechaCompletado: daysAgo(8),
    creadoPor: 'user-1',
    visitaId: 'visita-3',
    asuntoId: 'a6',
    createdAt: daysAgo(16),
    updatedAt: daysAgo(8),
  },
  {
    id: 'pend-10',
    proyectoId: 'proyecto-1',
    area: 'Terraza',
    tarea: 'Instalar deck de madera',
    descripcion: 'Deck de pino tratado 25m²',
    encargadoId: 'user-7',
    encargado: { id: 'user-7', nombre: 'David Castro', especialidad: 'Carpintero', telefono: '+56978901234' },
    estado: 'pausa',
    prioridad: 'media',
    fechaCreacion: daysAgo(5),
    fechaVencimiento: daysFromNow(10),
    creadoPor: 'user-2',
    createdAt: daysAgo(5),
    updatedAt: daysAgo(5),
  },
  // Baño de servicio
  {
    id: 'pend-11',
    proyectoId: 'proyecto-1',
    area: 'Baño de servicio',
    tarea: 'Instalar cerámicos piso',
    descripcion: 'Cerámico 45x45 antideslizante',
    encargadoId: 'user-3',
    encargado: { id: 'user-3', nombre: 'José Silva', especialidad: 'Constructor Civil', telefono: '+56934567890' },
    estado: 'en_obra',
    prioridad: 'alta',
    fechaCreacion: daysAgo(3),
    fechaVencimiento: daysFromNow(2),
    creadoPor: 'user-2',
    createdAt: daysAgo(3),
    updatedAt: daysAgo(1),
  },
  {
    id: 'pend-12',
    proyectoId: 'proyecto-1',
    area: 'Baño de servicio',
    tarea: 'Instalar WC y lavamanos',
    encargadoId: 'user-5',
    encargado: { id: 'user-5', nombre: 'Miguel Torres', especialidad: 'Gasfiter', telefono: '+56956789012' },
    estado: 'pausa',
    prioridad: 'media',
    fechaCreacion: daysAgo(3),
    fechaVencimiento: daysFromNow(6),
    creadoPor: 'user-2',
    createdAt: daysAgo(3),
    updatedAt: daysAgo(3),
  },
  // Pieza principal
  {
    id: 'pend-13',
    proyectoId: 'proyecto-1',
    area: 'Pieza principal',
    tarea: 'Instalar closet empotrado',
    descripcion: 'Closet de 3m con puertas correderas',
    encargadoId: 'user-7',
    encargado: { id: 'user-7', nombre: 'David Castro', especialidad: 'Carpintero', telefono: '+56978901234' },
    estado: 'pausa',
    prioridad: 'media',
    fechaCreacion: daysAgo(6),
    fechaVencimiento: daysFromNow(12),
    creadoPor: 'user-2',
    createdAt: daysAgo(6),
    updatedAt: daysAgo(6),
  },
  {
    id: 'pend-14',
    proyectoId: 'proyecto-1',
    area: 'Pieza principal',
    tarea: 'Pintar dormitorio',
    descripcion: 'Color gris perla, terminación satinada',
    encargadoId: 'user-6',
    encargado: { id: 'user-6', nombre: 'Andrés Fuentes', especialidad: 'Pintor', telefono: '+56967890123' },
    estado: 'pausa',
    prioridad: 'baja',
    fechaCreacion: daysAgo(6),
    fechaVencimiento: daysFromNow(15),
    creadoPor: 'user-2',
    createdAt: daysAgo(6),
    updatedAt: daysAgo(6),
  },
  // General
  {
    id: 'pend-7',
    proyectoId: 'proyecto-1',
    area: 'General',
    tarea: 'Revisar tablero eléctrico',
    descripcion: 'Verificar capacidad para nuevos circuitos',
    encargadoId: 'user-4',
    encargado: { id: 'user-4', nombre: 'Pedro Rojas', especialidad: 'Electricista', telefono: '+56945678901' },
    estado: 'terminado',
    prioridad: 'alta',
    fechaCreacion: daysAgo(20),
    fechaCompletado: daysAgo(12),
    creadoPor: 'user-3',
    createdAt: daysAgo(20),
    updatedAt: daysAgo(12),
  },
  {
    id: 'pend-15',
    proyectoId: 'proyecto-1',
    area: 'General',
    tarea: 'Limpieza general de obra',
    encargadoId: 'user-3',
    encargado: { id: 'user-3', nombre: 'José Silva', especialidad: 'Constructor Civil', telefono: '+56934567890' },
    estado: 'en_obra',
    prioridad: 'baja',
    fechaCreacion: daysAgo(1),
    creadoPor: 'user-1',
    createdAt: daysAgo(1),
    updatedAt: daysAgo(1),
  },
];

// Helpers para pendientes
export const getPendientesByArea = (area: string) =>
  mockPendientes.filter(p => p.area === area);

export const getPendientesByEncargado = (encargadoId: string) =>
  mockPendientes.filter(p => p.encargadoId === encargadoId);

export const getPendientesCountByArea = () => {
  const counts: Record<string, number> = {};
  mockPendientes.forEach(p => {
    if (p.estado !== 'terminado') {
      counts[p.area] = (counts[p.area] || 0) + 1;
    }
  });
  return counts;
};

// ==================== NOTAS DEL EQUIPO ====================

export const mockNotas: Nota[] = [
  {
    id: 'nota-1',
    proyectoId: 'proyecto-1',
    contenido: 'Cliente confirmó que quiere grifería de la marca Grohe para toda la casa. Coordinar compra.',
    area: 'General',
    autorId: 'user-2',
    autor: { id: 'user-2', nombre: 'Carlos Méndez' },
    convertidaAPendiente: false,
    createdAt: daysAgo(1),
    updatedAt: daysAgo(1),
  },
  {
    id: 'nota-2',
    proyectoId: 'proyecto-1',
    contenido: 'Los cerámicos de la cocina llegaron con 2 cajas dañadas. Solicitar reposición al proveedor.',
    area: 'Cocina',
    autorId: 'user-3',
    autor: { id: 'user-3', nombre: 'José Silva' },
    convertidaAPendiente: true,
    pendienteId: 'pend-16',
    createdAt: daysAgo(2),
    updatedAt: daysAgo(2),
  },
  {
    id: 'nota-3',
    proyectoId: 'proyecto-1',
    contenido: 'Revisar altura de enchufes en baño principal. Están más bajos de lo especificado en plano.',
    area: 'Baño principal',
    autorId: 'user-4',
    autor: { id: 'user-4', nombre: 'Pedro Rojas' },
    convertidaAPendiente: false,
    createdAt: daysAgo(3),
    updatedAt: daysAgo(3),
  },
  {
    id: 'nota-4',
    proyectoId: 'proyecto-1',
    contenido: 'Se detectó humedad en muro poniente de sala de estar. Posible filtración desde terraza.',
    area: 'Sala de estar',
    autorId: 'user-3',
    autor: { id: 'user-3', nombre: 'José Silva' },
    convertidaAPendiente: true,
    createdAt: daysAgo(4),
    updatedAt: daysAgo(4),
  },
  {
    id: 'nota-5',
    proyectoId: 'proyecto-1',
    contenido: 'Madera para deck ya está en obra. Iniciar instalación apenas termine impermeabilización.',
    area: 'Terraza',
    autorId: 'user-7',
    autor: { id: 'user-7', nombre: 'David Castro' },
    convertidaAPendiente: false,
    createdAt: daysAgo(5),
    updatedAt: daysAgo(5),
  },
  {
    id: 'nota-6',
    proyectoId: 'proyecto-1',
    contenido: 'Reunión con proveedor de luminarias el viernes a las 11:00 en obra.',
    area: 'General',
    autorId: 'user-1',
    autor: { id: 'user-1', nombre: 'María González' },
    convertidaAPendiente: false,
    createdAt: daysAgo(6),
    updatedAt: daysAgo(6),
  },
  {
    id: 'nota-7',
    proyectoId: 'proyecto-1',
    contenido: 'El color de pintura seleccionado para el dormitorio es Sherwin Williams SW7015 (Repose Gray).',
    area: 'Pieza principal',
    autorId: 'user-2',
    autor: { id: 'user-2', nombre: 'Carlos Méndez' },
    convertidaAPendiente: false,
    createdAt: daysAgo(7),
    updatedAt: daysAgo(7),
  },
  {
    id: 'nota-8',
    proyectoId: 'proyecto-1',
    contenido: 'Cambio aprobado: se agrega punto de agua para futura instalación de lavavajillas.',
    area: 'Cocina',
    autorId: 'user-1',
    autor: { id: 'user-1', nombre: 'María González' },
    convertidaAPendiente: false,
    createdAt: daysAgo(10),
    updatedAt: daysAgo(10),
  },
];

// ==================== DOCUMENTOS ====================

export const mockDocumentos: Documento[] = [
  {
    id: 'doc-1',
    proyectoId: 'proyecto-1',
    nombre: 'Plano Arquitectura v3',
    tipo: 'pdf',
    categoria: 'planos',
    url: '/docs/plano-arquitectura-v3.pdf',
    tamaño: 2500000,
    estado: 'aprobado',
    fechaAprobacion: daysAgo(30),
    subioPor: 'user-2',
    autor: { id: 'user-2', nombre: 'Carlos Méndez' },
    createdAt: daysAgo(35),
    updatedAt: daysAgo(30),
  },
  {
    id: 'doc-2',
    proyectoId: 'proyecto-1',
    nombre: 'Plano Eléctrico',
    tipo: 'dwg',
    categoria: 'planos',
    url: '/docs/plano-electrico.dwg',
    tamaño: 1800000,
    estado: 'aprobado',
    fechaAprobacion: daysAgo(25),
    subioPor: 'user-4',
    autor: { id: 'user-4', nombre: 'Pedro Rojas' },
    createdAt: daysAgo(28),
    updatedAt: daysAgo(25),
  },
  {
    id: 'doc-3',
    proyectoId: 'proyecto-1',
    nombre: 'Plano Sanitario',
    tipo: 'pdf',
    categoria: 'planos',
    url: '/docs/plano-sanitario.pdf',
    tamaño: 1200000,
    estado: 'aprobado',
    subioPor: 'user-5',
    autor: { id: 'user-5', nombre: 'Miguel Torres' },
    createdAt: daysAgo(28),
    updatedAt: daysAgo(20),
  },
  {
    id: 'doc-4',
    proyectoId: 'proyecto-1',
    nombre: 'Anteproyecto Aprobado',
    tipo: 'pdf',
    categoria: 'anteproyecto',
    url: '/docs/anteproyecto.pdf',
    tamaño: 5500000,
    estado: 'aprobado',
    fechaAprobacion: daysAgo(90),
    subioPor: 'user-2',
    autor: { id: 'user-2', nombre: 'Carlos Méndez' },
    createdAt: daysAgo(100),
    updatedAt: daysAgo(90),
  },
  {
    id: 'doc-5',
    proyectoId: 'proyecto-1',
    nombre: 'Presupuesto Detallado',
    tipo: 'xlsx',
    categoria: 'presupuesto',
    url: '/docs/presupuesto-detallado.xlsx',
    tamaño: 450000,
    estado: 'revision',
    subioPor: 'user-1',
    autor: { id: 'user-1', nombre: 'María González' },
    createdAt: daysAgo(15),
    updatedAt: daysAgo(5),
  },
  {
    id: 'doc-6',
    proyectoId: 'proyecto-1',
    nombre: 'Contrato Construcción',
    tipo: 'pdf',
    categoria: 'contratos',
    url: '/docs/contrato-construccion.pdf',
    tamaño: 320000,
    estado: 'aprobado',
    fechaAprobacion: daysAgo(85),
    subioPor: 'user-1',
    autor: { id: 'user-1', nombre: 'María González' },
    createdAt: daysAgo(88),
    updatedAt: daysAgo(85),
  },
  {
    id: 'doc-7',
    proyectoId: 'proyecto-1',
    nombre: 'Fotos Avance Semana 12',
    tipo: 'jpg',
    categoria: 'fotos',
    url: '/docs/fotos-semana-12.zip',
    tamaño: 15000000,
    subioPor: 'user-3',
    autor: { id: 'user-3', nombre: 'José Silva' },
    createdAt: daysAgo(2),
    updatedAt: daysAgo(2),
  },
  {
    id: 'doc-8',
    proyectoId: 'proyecto-1',
    nombre: 'Fotos Avance Semana 11',
    tipo: 'jpg',
    categoria: 'fotos',
    url: '/docs/fotos-semana-11.zip',
    tamaño: 12000000,
    subioPor: 'user-3',
    autor: { id: 'user-3', nombre: 'José Silva' },
    createdAt: daysAgo(9),
    updatedAt: daysAgo(9),
  },
  {
    id: 'doc-9',
    proyectoId: 'proyecto-1',
    nombre: 'Especificaciones Técnicas Cocina',
    tipo: 'pdf',
    categoria: 'otro',
    url: '/docs/specs-cocina.pdf',
    tamaño: 890000,
    estado: 'aprobado',
    subioPor: 'user-2',
    autor: { id: 'user-2', nombre: 'Carlos Méndez' },
    createdAt: daysAgo(40),
    updatedAt: daysAgo(35),
  },
];

// ==================== NOTIFICACIONES ====================

export const mockNotificaciones: Notificacion[] = [
  {
    id: 'notif-1',
    usuarioId: 'user-1',
    tipo: 'visita_programada',
    titulo: 'Próxima visita programada',
    mensaje: 'Tienes una visita programada para el ' + daysFromNow(3).toLocaleDateString('es-CL') + ' a las 10:00.',
    leida: false,
    metadata: { visitaId: 'visita-0' },
    enlaceAccion: '/visitas',
    createdAt: daysAgo(1),
  },
  {
    id: 'notif-2',
    usuarioId: 'user-1',
    tipo: 'tarea_asignada',
    titulo: 'Nueva tarea asignada',
    mensaje: 'Se te ha asignado la tarea "Revisar instalación de muebles bajo mesón" en Cocina.',
    leida: false,
    metadata: { pendienteId: 'pend-1' },
    enlaceAccion: '/pendientes',
    createdAt: daysAgo(2),
  },
  {
    id: 'notif-3',
    usuarioId: 'user-1',
    tipo: 'documento_subido',
    titulo: 'Nuevo documento',
    mensaje: 'José Silva subió "Fotos Avance Semana 12" en la categoría Fotos.',
    leida: false,
    metadata: { documentoId: 'doc-7' },
    enlaceAccion: '/documentos',
    createdAt: daysAgo(2),
  },
  {
    id: 'notif-4',
    usuarioId: 'user-1',
    tipo: 'tarea_actualizada',
    titulo: 'Tarea completada',
    mensaje: 'Miguel Torres completó la tarea "Conectar grifería" en Cocina.',
    leida: true,
    metadata: { pendienteId: 'pend-4' },
    enlaceAccion: '/pendientes',
    createdAt: daysAgo(3),
  },
  {
    id: 'notif-5',
    usuarioId: 'user-1',
    tipo: 'presupuesto_actualizado',
    titulo: 'Actualización de presupuesto',
    mensaje: 'Se actualizó el monto real de "Muebles de cocina" a $4.200.000.',
    leida: true,
    metadata: { presupuestoItemId: 'budget-3' },
    enlaceAccion: '/presupuesto',
    createdAt: daysAgo(4),
  },
  {
    id: 'notif-6',
    usuarioId: 'user-1',
    tipo: 'mensaje',
    titulo: 'Mensaje del equipo',
    mensaje: 'Carlos Méndez dejó una nota: "Cliente confirmó grifería Grohe para toda la casa."',
    leida: true,
    metadata: { notaId: 'nota-1' },
    enlaceAccion: '/notas',
    createdAt: daysAgo(1),
  },
  {
    id: 'notif-7',
    usuarioId: 'user-1',
    tipo: 'tarea_actualizada',
    titulo: 'Tarea completada',
    mensaje: 'José Silva completó la tarea "Completar impermeabilización" en Terraza.',
    leida: true,
    metadata: { pendienteId: 'pend-8' },
    enlaceAccion: '/pendientes',
    createdAt: daysAgo(8),
  },
  {
    id: 'notif-8',
    usuarioId: 'user-1',
    tipo: 'visita_programada',
    titulo: 'Visita completada',
    mensaje: 'La visita del ' + daysAgo(2).toLocaleDateString('es-CL') + ' fue marcada como completada.',
    leida: true,
    metadata: { visitaId: 'visita-1' },
    enlaceAccion: '/visitas',
    createdAt: daysAgo(2),
  },
];

// Helper para notificaciones no leídas
export const getUnreadNotificationsCount = () =>
  mockNotificaciones.filter(n => !n.leida).length;

// ==================== PRESUPUESTO ====================

export const mockPresupuestoItems: PresupuestoItem[] = [
  // Diseño
  {
    id: 'budget-1',
    proyectoId: 'proyecto-1',
    categoria: 'diseño',
    descripcion: 'Honorarios arquitectura',
    montoEstimado: 8000000,
    montoReal: 8000000,
    porcentajeEjecutado: 100,
    notificaCambios: true,
    createdAt: daysAgo(100),
    updatedAt: daysAgo(30),
  },
  {
    id: 'budget-2',
    proyectoId: 'proyecto-1',
    categoria: 'diseño',
    descripcion: 'Diseño de interiores',
    montoEstimado: 3500000,
    montoReal: 3500000,
    porcentajeEjecutado: 100,
    notificaCambios: false,
    createdAt: daysAgo(100),
    updatedAt: daysAgo(45),
  },
  // Construcción
  {
    id: 'budget-3',
    proyectoId: 'proyecto-1',
    categoria: 'construccion',
    descripcion: 'Obra gruesa y terminaciones',
    montoEstimado: 35000000,
    montoReal: 28000000,
    porcentajeEjecutado: 80,
    notificaCambios: true,
    createdAt: daysAgo(90),
    updatedAt: daysAgo(2),
  },
  {
    id: 'budget-4',
    proyectoId: 'proyecto-1',
    categoria: 'construccion',
    descripcion: 'Instalaciones eléctricas',
    montoEstimado: 4500000,
    montoReal: 4800000, // Sobrepresupuesto
    porcentajeEjecutado: 95,
    notificaCambios: true,
    createdAt: daysAgo(90),
    updatedAt: daysAgo(5),
  },
  {
    id: 'budget-5',
    proyectoId: 'proyecto-1',
    categoria: 'construccion',
    descripcion: 'Instalaciones sanitarias',
    montoEstimado: 3500000,
    montoReal: 3200000,
    porcentajeEjecutado: 85,
    notificaCambios: true,
    createdAt: daysAgo(90),
    updatedAt: daysAgo(3),
  },
  // Materiales
  {
    id: 'budget-6',
    proyectoId: 'proyecto-1',
    categoria: 'materiales',
    descripcion: 'Cerámicos y porcelanatos',
    montoEstimado: 6000000,
    montoReal: 5800000,
    porcentajeEjecutado: 100,
    notificaCambios: false,
    createdAt: daysAgo(80),
    updatedAt: daysAgo(10),
  },
  {
    id: 'budget-7',
    proyectoId: 'proyecto-1',
    categoria: 'materiales',
    descripcion: 'Griferías y sanitarios',
    montoEstimado: 4000000,
    montoReal: 4500000, // Sobrepresupuesto (upgrade a Grohe)
    porcentajeEjecutado: 100,
    notificaCambios: true,
    createdAt: daysAgo(80),
    updatedAt: daysAgo(5),
  },
  {
    id: 'budget-8',
    proyectoId: 'proyecto-1',
    categoria: 'materiales',
    descripcion: 'Pinturas y revestimientos',
    montoEstimado: 2500000,
    montoReal: 800000,
    porcentajeEjecutado: 32,
    notificaCambios: false,
    createdAt: daysAgo(80),
    updatedAt: daysAgo(7),
  },
  {
    id: 'budget-9',
    proyectoId: 'proyecto-1',
    categoria: 'materiales',
    descripcion: 'Madera terraza (deck)',
    montoEstimado: 3000000,
    montoReal: 0,
    porcentajeEjecutado: 0,
    notificaCambios: false,
    createdAt: daysAgo(60),
    updatedAt: daysAgo(60),
  },
  // Mobiliario
  {
    id: 'budget-10',
    proyectoId: 'proyecto-1',
    categoria: 'mobiliario',
    descripcion: 'Muebles de cocina',
    montoEstimado: 8000000,
    montoReal: 4200000,
    porcentajeEjecutado: 52,
    notificaCambios: true,
    createdAt: daysAgo(70),
    updatedAt: daysAgo(4),
  },
  {
    id: 'budget-11',
    proyectoId: 'proyecto-1',
    categoria: 'mobiliario',
    descripcion: 'Closets y muebles baño',
    montoEstimado: 5000000,
    montoReal: 0,
    porcentajeEjecutado: 0,
    notificaCambios: false,
    createdAt: daysAgo(70),
    updatedAt: daysAgo(70),
  },
  // Otro
  {
    id: 'budget-12',
    proyectoId: 'proyecto-1',
    categoria: 'otro',
    descripcion: 'Permisos y derechos municipales',
    montoEstimado: 1500000,
    montoReal: 1500000,
    porcentajeEjecutado: 100,
    notificaCambios: false,
    createdAt: daysAgo(100),
    updatedAt: daysAgo(80),
  },
  {
    id: 'budget-13',
    proyectoId: 'proyecto-1',
    categoria: 'otro',
    descripcion: 'Imprevistos',
    montoEstimado: 500000,
    montoReal: 250000,
    porcentajeEjecutado: 50,
    notificaCambios: true,
    createdAt: daysAgo(100),
    updatedAt: daysAgo(15),
  },
];

// Helpers para presupuesto
export const getPresupuestoTotal = () => ({
  estimado: mockPresupuestoItems.reduce((sum, item) => sum + item.montoEstimado, 0),
  real: mockPresupuestoItems.reduce((sum, item) => sum + (item.montoReal || 0), 0),
});

export const getPresupuestoByCategoria = (categoria: string) =>
  mockPresupuestoItems.filter(item => item.categoria === categoria);

// ==================== PERMISOS ====================

export const mockPermisos: Permiso[] = [
  {
    id: 'permiso-1',
    proyectoId: 'proyecto-1',
    nombre: 'Permiso de Edificación',
    tipo: 'edificacion',
    estado: 'aprobado',
    fechaSolicitud: daysAgo(120),
    fechaAprobacion: daysAgo(95),
    fechaVencimiento: daysFromNow(270),
    vigenciaMeses: 12,
    documentoId: 'doc-permiso-1',
    notas: 'Aprobado sin observaciones.',
    createdAt: daysAgo(120),
    updatedAt: daysAgo(95),
  },
  {
    id: 'permiso-2',
    proyectoId: 'proyecto-1',
    nombre: 'Patente Municipal',
    tipo: 'municipal',
    estado: 'aprobado',
    fechaSolicitud: daysAgo(100),
    fechaAprobacion: daysAgo(90),
    fechaVencimiento: daysFromNow(275),
    vigenciaMeses: 12,
    createdAt: daysAgo(100),
    updatedAt: daysAgo(90),
  },
  {
    id: 'permiso-3',
    proyectoId: 'proyecto-1',
    nombre: 'Recepción Final de Obra',
    tipo: 'recepcion_obra',
    estado: 'pendiente',
    notas: 'Solicitar al finalizar obra.',
    createdAt: daysAgo(30),
    updatedAt: daysAgo(30),
  },
  {
    id: 'permiso-4',
    proyectoId: 'proyecto-1',
    nombre: 'Certificado de Instalación Eléctrica',
    tipo: 'otro',
    estado: 'en_tramite',
    fechaSolicitud: daysAgo(10),
    notas: 'En revisión por SEC.',
    createdAt: daysAgo(10),
    updatedAt: daysAgo(5),
  },
];

// ==================== EXPORT PROYECTO COMPLETO ====================

// Proyecto con todas las relaciones cargadas (para vistas que lo necesiten)
export const mockProyectoCompleto: Proyecto = {
  ...mockProyecto,
  usuarios: mockUsers,
  visitas: mockVisitas,
  pendientes: mockPendientes,
  documentos: mockDocumentos,
  notas: mockNotas,
  presupuestoItems: mockPresupuestoItems,
};

// ==================== CURRENT USER (para demo) ====================

export const currentUser = mockUsers[0]; // María González (admin)
